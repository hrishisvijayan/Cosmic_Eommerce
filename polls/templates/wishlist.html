{% extends 'base.html' %}
{% load static %}
{% block content %}


<div class="hero_area">
  <!-- header section strats -->
  <header class="header_section">
    <div class="header_top">
      <div class="container-fluid">
        <div class="top_nav_container">
          <div class="contact_nav">
            <a href="">
              <i class="fa fa-phone" aria-hidden="true"></i>
              <span>
                Call : +01 123455678990
              </span>
            </a>
            <a href="">
              <i class="fa fa-envelope" aria-hidden="true"></i>
              <span>
                Email : django@gmail.com
              </span>
            </a>
          </div>
          <form class="search_form">
            <input type="text" class="form-control" placeholder="Search here...">
            <button class="" type="submit">
              <i class="fa fa-search" aria-hidden="true"></i>
            </button>
          </form>
          <div class="user_option_box">
            <a href="{% url 'logout' %}" class="account-link">
              <i class="fa fa-user" aria-hidden="true"></i>
              <span>
                logout
              </span>
            </a>
            <a href="{% url 'user_checkout' %}" class="cart-link">
              <i class="fa fa-shopping-cart" aria-hidden="true"></i>
              <span>
                Cart
              </span>
            </a>
          </div>
        </div>

      </div>
    </div>
    <div class="header_bottom">
      <div class="container-fluid">
        <nav class="navbar navbar-expand-lg custom_nav-container ">
          <a class="navbar-brand" href="index.html">
            <span>
              COSMICS
            </span>
          </a>

          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class=""> </span>
          </button>

          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ">
              <li class="nav-item active">
                <a class="nav-link" href="{% url 'cosmic' %}">Home <span class="sr-only">(current)</span></a>
              </li>
              <!-- <li class="nav-item">
                <a class="nav-link" href="#about_section"> About</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#products">Products</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#why">Why Us</a>
              </li> -->
              <li class="nav-item">
                <!-- <a class="nav-link" href="testimonial.html">Testimonial</a> -->
              </li>
            </ul>
          </div>
        </nav>
      </div>
    </div>
  </header>

  <!--cart section start here-->
  <div class="container my-5 ">
    <!-- <div class="cart container-fluid m-0 p-3 mx-auto w-50">
      <div class="cart-top d-flex justify-content-between p-3 " style="height: fit-content;">
        <div>
          <h2 class="cart-top-title p-0">Checkout</h2>
        </div>
        <div>
          Quantity
        </div>
        <div class="cart-top-info">3 items</div>
      </div>

      <div class="cartcontent ">

        <div class="d-flex justify-content-between p-3 ">
        <div class="cart-item">
          <span class="cart-item-pic">
            <img src="http://upload.wikimedia.org/wikipedia/en/a/a7/Random_Access_Memories.jpg">
          </span>
          Item #1
          <span class="cart-item-desc">Description</span>
          <span class="cart-item-price">$16.80</span>
          <a href=""> <button style="border-radius: 20px; background-color: yellow;">Remove</button> </a>
        </div>

        <div>
          <div id="app bg-dark">
            <div class="wrapper d-flex">
                  <button class="btn btn--minus" @click="changeCounter('-1')" type="button" name="button">
                  -
                  </button>
                  <input class="quantity w-25" type="text" name="name" :value="counter" >
                  <button class="btn btn--plus" @click="changeCounter('1')" type="button" name="button">
                    +
                  </button>
                </div>
        
          </div>
        </div>
        <div>
          <a href=""> <button style="border-radius: 20px; background-color: yellow;">Remove</button> </a>

        </div>
      </div>

        <div class="cart-bottom">
          Total: $54.80
          <a href="{% url 'address' %}" class="cart-button">Continue</a>
        </div>
      </div>
    </div> -->


 
<!-- <div class="row">
    {% for product in products %}
        <div class="col-sm-6 col-lg-3" id="div{{ product.id }}">
            <div class="card text-center m-3 w-100 position-relative">
                <a href="#" style="text-decoration: none;">
                    <center class="max-ht-500 mt-3 d-flex align-items-center justify-content-center"><img
                            src="{{product.image1.url}}" alt="" class="card-img-top img"></center>
                </a>
                <button class="position-absolute btn rounded-circle btn-light fav" data-value="{{ product.id }}"
                    id="fav{{ product.id }}">
                    <i class="fas fa-heart text-danger"></i></button>
                <a href="#" style="text-decoration: none;">
                    <h5 class="card-title">{{product.name}}</h5>
                </a>
                <a href="#" style="text-decoration: none;">
                    <p class="card-text">{{product.ram}} | {{product.storage}}</p>
                </a>
                <a href="#" style="text-decoration: none;"
                    class="d-flex justify-content-around">
                    {% if product.price == product.last_price %}
                    <h5>₹ {{ product.price }}</h5>
                    {% else %}
                    <h5>₹ {{ product.last_price }}</h5> <strike>
                        <p>₹ {{ product.price }}</p>
                    </strike>
                    <p class="text-success">
                        {{ product.offer }}% off</p>
                    {% endif %}
                </a>

                <div class="d-flex justify-content-around pb-3"><button class="btn btn-info px-4 add_cart"
                        data-id="{{ product.id }}"><i class="fas fa-shopping-cart"></i> Cart</button>
                    <a href="{% url 'buyNow' product.id %}">
                        <button class="btn btn-info "><i class="fa-solid fa-bolt"></i> Buy Now</button></a>
                </div>
            </div>
        </div>
        {% endfor %}

</div> -->


   
<h1 class="text-primary m-5" style="font-size: 25px;" > Wish List </h1>
<div class="container" >
<div class="row justify-content-between">
  {% for product in products %}
  <div class="col-sm-6 col-lg-4">
    <div class="box  m-3 p-3">
      <div class="img-box"  >
        <img style="width: 250px;height:225px" src="{{ product.image1.url }}"  alt="hello" >
        <a href="" class="add_cart_btn ">
          <button class="btn add_cart" data-product='{{ product.id }} ' style="margin-left:106px;"  add_cart_btn update-cart > <!--here the data-product is written in below script section-->
            Add To Cart
          </button>
        </a>
      </div>
     <a href="{% url 'buyNow' product.id %}">  <button class="btn btn-success "  style="margin-left: 35%;"  >Buy Now</button>  </a> 
      <div class="detail-box">
        <h5>
          <a href="{% url 'product_details' product.id %}" style="color: black;  " style="text-align: right;"  > {{ product.name }} </a>
        </h5>
        <div class="product_info "  >
          <h5>
            <span>₹</span>  <del> {{ product.price }} </del>  <br> <span>₹</span> {{ product.last_price }}
          </h5>
          <div class="star_container mb-5" style="text-align: end ;">
            <i class="fa fa-star" aria-hidden="true"></i>
            <i class="fa fa-star" aria-hidden="true"></i>
            <i class="fa fa-star" aria-hidden="true"></i>
            <i class="fa fa-star" aria-hidden="true"></i>
            <i class="fa fa-star" aria-hidden="true"></i>
           
          </div>
         
          <button class="position-absolute btn rounded-circle btn-light fav bg-light" style="margin-left: 146px; margin-top:-66px;" data-value="{{ product.id }}" id="fav{{ item.id }}">
            <i class="fas fa-heart text-danger bg-light"></i></button>
         
        </div>
      </div>
    </div>
  </div>
  {% endfor %}



</div>

</div>

    
  </div>



 





  <!-- end header section -->
  <!-- slider section -->


  <!-- product section -->

  <!-- client section -->
  <!-- 
  <section class="client_section layout_padding-bottom">
    <div class="container">
      <div class="heading_container heading_center">
        <h2>
          What Says Our Customers
        </h2>
      </div>
    </div>
    <div class="client_container ">
      <div id="carouselExample2Controls" class="carousel slide" data-ride="carousel">
        <div class="carousel-inner">
          <div class="carousel-item active">
            <div class="container">
              <div class="box">
                <div class="detail-box">
                  <p>
                    <i class="fa fa-quote-left" aria-hidden="true"></i>
                  </p>
                  <p>
                    It is a long established fact that a reader will be distracted by the readable content of a page
                    when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal
                    distribution of letters, as opposed to using 'Content here, content here', making it lookIt is a
                    long established fact that a reader will be distracted by the readable content of a page when
                    looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal
                    distribution of letters, as opposed to using 'Content here, content here', making it look
                  </p>
                </div>
                <div class="client-id">
                  <div class="img-box">
                    <img src="images/client.jpg" alt="">
                  </div>
                  <div class="name">
                    <h5>
                      James Dew
                    </h5>
                    <h6>
                      Photographer
                    </h6>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="carousel-item">
            <div class="container">
              <div class="box">
                <div class="detail-box">
                  <p>
                    <i class="fa fa-quote-left" aria-hidden="true"></i>
                  </p>
                  <p>
                    It is a long established fact that a reader will be distracted by the readable content of a page
                    when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal
                    distribution of letters, as opposed to using 'Content here, content here', making it lookIt is a
                    long established fact that a reader will be distracted by the readable content of a page when
                    looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal
                    distribution of letters, as opposed to using 'Content here, content here', making it look
                  </p>
                </div>
                <div class="client-id">
                  <div class="img-box">
                    <img src="images/client.jpg" alt="">
                  </div>
                  <div class="name">
                    <h5>
                      James Dew
                    </h5>
                    <h6>
                      Photographer
                    </h6>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="carousel-item">
            <div class="container">
              <div class="box">
                <div class="detail-box">
                  <p>
                    <i class="fa fa-quote-left" aria-hidden="true"></i>
                  </p>
                  <p>
                    It is a long established fact that a reader will be distracted by the readable content of a page
                    when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal
                    distribution of letters, as opposed to using 'Content here, content here', making it lookIt is a
                    long established fact that a reader will be distracted by the readable content of a page when
                    looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal
                    distribution of letters, as opposed to using 'Content here, content here', making it look
                  </p>
                </div>
                <div class="client-id">
                  <div class="img-box">
                    <img src="images/client.jpg" alt="">
                  </div>
                  <div class="name">
                    <h5>
                      James Dew
                    </h5>
                    <h6>
                      Photographer
                    </h6>
                  </div>
                </div>
              </div> -->
  <!-- </div>
          </div>
        </div>
        <div class="carousel_btn-box">
          <a class="carousel-control-prev" href="#carouselExample2Controls" role="button" data-slide="prev">
            <span>
              <i class="fa fa-angle-left" aria-hidden="true"></i>
            </span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="carousel-control-next" href="#carouselExample2Controls" role="button" data-slide="next">
            <span>
              <i class="fa fa-angle-right" aria-hidden="true"></i>
            </span>
            <span class="sr-only">Next</span>
          </a>
        </div>
      </div>
    </div>
  </section> -->
  <!-- end client section -->

  <!-- info section -->
  <section class="info_section ">
    <div class="container">
      <div class="row">
        <div class="col-md-3">
          <div class="info_contact">
            <h5>
              <a href="" class="navbar-brand">
                <span>
                  Minics
                </span>
              </a>
            </h5>
            <p>
              <i class="fa fa-map-marker" aria-hidden="true"></i>
              Address
            </p>
            <p>
              <i class="fa fa-phone" aria-hidden="true"></i>
              +01 1234567890
            </p>
            <p>
              <i class="fa fa-envelope" aria-hidden="true"></i>
              demo@gmail.com
            </p>
          </div>
        </div>
        <div class="col-md-3">
          <div class="info_info">
            <h5>
              Information
            </h5>
            <p>
              Eligendi sunt, provident, debitis nemo, facilis cupiditate velit libero dolorum aperiam enim nulla iste
              maxime corrupti ad illo libero minus.
            </p>
          </div>
        </div>
        <div class="col-md-3">
          <div class="info_links">
            <h5>
              Useful Link
            </h5>
            <ul>
              <li>
                <a href="index.html">
                  Home
                </a>
              </li>
              <li>
                <a href="about.html">
                  About
                </a>
              </li>
              <li>
                <a href="product.html">
                  Products
                </a>
              </li>
              <li>
                <a href="why.html">
                  Why Us
                </a>
              </li>
              <li>
                <!-- <a href="testimonial.html">
                  Testimonial
                </a> -->
              </li>
            </ul>
          </div>
        </div>
        <div class="col-md-3">
          <div class="info_form ">
            <h5>
              Newsletter
            </h5>
            <form action="">
              <input type="email" placeholder="Enter your email">
              <button>
                Subscribe
              </button>
            </form>
            <div class="social_box">
              <a href="">
                <i class="fab fa-facebook-f"></i>
              </a>
              <a href="">
                <i class="fab fa-twitter-square"></i>
              </a>
              <a href="">

                <i class="fab fa-instagram"></i>
              </a>
              <a href="">

                <i class="fab fa-youtube"></i>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- end info_section -->


  <!-- footer section -->
  <footer class="footer_section">
    <div class="container">
      <p>
        &copy; <span id="displayYear"></span> All Rights Reserved By
        <a href="https://html.design/"> django house </a>
      </p>
    </div>
  </footer>
  <!-- footer section -->

  <!-- jQery -->

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <script src="https://www.paypal.com/sdk/js?client-id=AeS1O53pS0XIj2PQq6VCwSi4eTAhyFwrm04d-I8l8sYKaPdVOOFPq87afE5QgTGDQM6jd-K01_5Mu2p-&currency=USD" data-sdk-integration-source="button-factory"></script>

    <!--salmu code starts from here -->


    <!-- <script>
      console.log('salman')
      var total_amount = parseFloat('{{order.get_cart_total}}')
      var inr_total = total_amount/75
      paypal_sdk.Buttons({
  
        // Sets up the transaction when a payment button is clicked
        createOrder: function(data, actions) {
          return actions.order.create({
            purchase_units: [{
              amount: {
                value: inr_total.toFixed(2) // Can reference variables or functions. Example: `value: document.getElementById('...').value`
              }
            }]
          });
        },
  
        // Finalize the transaction after payer approval
        onApprove: function(data, actions) {
          return actions.order.capture().then(function(orderData) {
            // Successful capture! For dev/demo purposes:
                
                var transaction = orderData.purchase_units[0].payments.captures[0];
                
            console.log('salman')
            // When ready to go live, remove the alert and show a success message within this page. For example:
            // var element = document.getElementById('paypal-button-container');
            // element.innerHTML = '';
            // element.innerHTML = '<h3>Thank you for your payment!</h3>';
            // Or go to another URL:  actions.redirect('thank_you.html');
               data = {
                  'order_id': orderData.id,
              }
              $.ajax({
                  
                  method :"POST",
                  url: "/order_by_paypal",
                  data: data,
                  
                  success: function (responsec) {
                      alert("Success");
                      window.location.href = '/'
                      
                      
                  }
              });  
          });
        }
      }).render('#paypal-button-container');
  
    </script> -->




 
    <!--salmu code ends here-->




    <!--wafi code starts from here-->
  //<script>
  //  var price = parseFloat('{{ order.get_cart_total }}')
  //  console.log(price)
  //  paypal.Buttons({
//
  //    // Sets up the transaction when a payment button is clicked
  //    createOrder: function (data, actions) {
  //      return actions.order.create({
  //        purchase_units: [{
  //          amount: {
  //            value: parseFloat(price).toFixed(2) // Can reference variables or functions. Example: `value: document.getElementById('...').value`
  //          }
  //        }]
  //      });
  //    },
//
  //    // Finalize the transaction after payer approval
  //    onApprove: function (data, actions) {
  //      return actions.order.capture().then(function (orderData) {
//
  //        
  //        // Successful capture! For dev/demo purposes:
  //        console.log('Capture result', orderData, JSON.stringify(orderData, null, 2))
  //       // var transaction = orderData.purchase_units[0].payments.captures[0];
  //        //alert('Transaction ' + transaction.status + ': ' + transaction.id + '\n\nSee console for all available details');
//
  //        // When ready to go live, remove the alert and show a success message within this page. For example:
  //        // var element = document.getElementById('paypal-button-container');
  //        // element.innerHTML = '';
  //        // element.innerHTML = '<h3>Thank you for your payment!</h3>';
  //        // Or go to another URL:  actions.redirect('thank_you.html');
  //      });
  //    }
  //  }).render('#paypal-button-container');
//
  //</script>

  <script>
    // Render the PayPal button into #paypal-button-container
    var totalinr = parseFloat('{{ order.get_cart_total }}')
    var totalamt = totalinr / 75
    paypal.Buttons({
            // Set up the transaction
            createOrder: function (data, actions) {
                return actions.order.create({
                    purchase_units: [
                        {
                            amount: {
                                value: parseFloat(totalamt).toFixed(2),
                            },
                        },
                    ],
                });
            },

            onApprove: function (data, actions) {
              return actions.order.capture().then(function (orderData) {
                console.log(
                  "Capture result",
                  orderData,
                  JSON.stringify(orderData, null, 2)
                );
                $.ajax({
                  method: "POST",
                  url: '{% url "order_by_paypal" %}',
                  data: {'data':data},
                  
                  success: function (responsec) {
                      Swal.fire({
                          position: 'top-end',
                          icon: 'success',
                          title: 'Your order has been placed',
                          showConfirmButton: false,
                          timer: 1500
                      })
                      location = '{% url "cosmic" %}';
                  }
              });
              });
            },
          })
          .render("#paypal-button-container");

            // Finalize the transaction
           
</script>




  <!--////////////////////////wafi////////////wafirazorpay///////////////-->
  <!-- <script>
      // Render the PayPal button into #paypal-button-container
      var rs_in = parseFloat('{{ order.get_cart_total }}')
      var total_usd = rs_in / 75
      paypal
        .Buttons({
          // Set up the transaction
          createOrder: function (data, actions) {
            return actions.order.create({
              purchase_units: [
                {
                  amount: {
                    value: parseFloat(total_usd).toFixed(2),
                  },
                },
              ],
            });
          },
    
          // Finalize the transaction
          onApprove: function (data, actions) {
            return actions.order.capture().then(function (orderData) {
              console.log(
                "Capture result",
                orderData,
                JSON.stringify(orderData, null, 2)
              );
              order_place();
            });
          },
        })
        .render("#paypal-button-container");
    </script> -->

  <script>
    $(document).ready(function () {

      $('#rzp-button1').click(function () {
        var address = $('input[name="address"]:checked').val();


        $.ajax({
          method: 'GET',
          url: '{% url "razorpay" %}',
          data: {
            address: address
          },
          success: function (response) {
            console.log(response)


            var options = {
              "key": "rzp_test_3N7o3ki2CcSEKS", // Enter the Key ID generated from the Dashboard
              "amount": response.total * 100, // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
              "currency": "INR",
              "name": "Hrishi S Vijayan",
              "description": "Thank you for buying from us",
              "image": "https://example.com/your_logo",
              "handler": function (response) {
                alert(response.razorpay_payment_id);
                order_place();
              },
              "prefill": {
                "name": response.name,
                "email": response.email,
                "contact": response.phone
              },
              "theme": {
                "color": "#3399cc"
              }
            };
            var rzp1 = new Razorpay(options);
            rzp1.open();

          }
        })

      })

    })
  </script>

  <script>
    var address = $('input[name="address"]:checked').val();
    $("#proceed").on("click", function (e) {
      console.log('hello proceed')
      order_place();
    });
    function order_place() {
      alert("Michu")
      var payment = $('input[name="payment"]:checked').val();
      var address = $('input[name="address"]:checked').val();
      $.ajax({
        type: "POST",
        url: "{% url 'proceed' %}",
        data: {
          payment: payment,
          address: address,
          csrfmiddlewaretoken: "{{ csrf_token }}",
        },
        dataType: "json",
        success: function (response) {
          location = '{% url "home" %}';
        },
      });

    }

    $("input[type=radio][name=address]").change(function () {
      var id = "#" + $(this).val();
      var html = "<h3>SELECTED ADDRESS</h3>" + $(id).html();
      $(".selected").html(html);
      $(".selected input").remove();
    });

    $("input[type=radio][name=payment]").click(function () {
      var address = $('input[name="address"]:checked').val();
      var id = "div" + $(this).val();
    //  if (address != undefined) {
    //    if ($("#div_COD").hasClass("d-block")) {
    //      var element = document.getElementById("div_COD");
    //      element.classList.toggle("d-block");
    //      element.classList.toggle("d-none");
    //    }
    //    if ($("#div_PayPal").hasClass("d-block")) {
    //      var element = document.getElementById("div_PayPal");
    //      element.classList.toggle("d-block");
    //      element.classList.toggle("d-none");
    //    }
    //    if ($("#div_RazorPay").hasClass("d-block")) {
    //      var element = document.getElementById("div_RazorPay");
    //      element.classList.toggle("d-block");
    //      element.classList.toggle("d-none");
    //    }
    //    var element = document.getElementById(_id);
    //    element.classList.toggle("d-block");
    //    element.classList.toggle("d-none");
    //  } else {
    //    alert("please select address");
    //  }
    });
  </script>

  <!--////////////////////////wafi razor pay over//////////////////////////-->



  
  <script>

    $('.remove_from_wishlist').on('click',function (e) {
        var id = $(this).data('id')
  console.log(id)
        data = {
            'id':id,
        }
  var flag = 0
        Swal.fire({
            title: 'Are you sure?',
            text: "",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes, Remove it!'
          }).then((result) => {
            if (result.isConfirmed) {
                $.ajax({
                    url: "/remove_from_wishlist",
                    data: data,
                    dataType:'json',
                    success:function(res){
          Swal.fire(
                            'Removed!',
                            'Product has been successfully removed.',
                            'success'
                        ).then((result) => {
            location.reload()

          })  
                    }
                })
      
                
            }
          })
        
    });
    $('.fav').click(function () {
      $.ajax({
          url: '{% url "wishList" %}',
          data: {
              product_id: $(this).data('value')
          },
          success: function (response) {
              location.reload()
          }
      })
  });
</script>






  {% endblock %}